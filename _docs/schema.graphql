input AdvancedSearchInput {
  query: String!
}

"""Legacy authentication response"""
type AuthResponse {
  """JWT access token (deprecated, use AuthTokens instead)"""
  token: String
}

"""Result of authentication operations (signup/login)"""
union AuthResult = AuthSuccess | AuthenticationError | ConflictError | RateLimitError | ValidationError

"""Successful authentication result"""
type AuthSuccess {
  """Token expiration time"""
  expiresAt: DateTime

  """JWT authentication token"""
  token: String

  """The authenticated user"""
  user: User
}

"""Authentication tokens response"""
type AuthTokens {
  """JWT access token for API requests"""
  accessToken: String

  """Refresh token for obtaining new access tokens"""
  refreshToken: String
}

type AuthenticationError {
  code: String
  message: String
  statusCode: Int
}

type AuthorizationError {
  code: String
  message: String
  statusCode: Int
}

input BooleanFilter {
  """Exact boolean match"""
  equals: Boolean

  """Boolean does not equal this value"""
  not: Boolean
}

type ConflictError {
  code: String
  message: String
  statusCode: Int
}

input CreatePostInput {
  content: String
  published: Boolean = false
  title: String!
}

scalar DID

"""Date range"""
type DateRange {
  """End date"""
  end: DateTime

  """Start date"""
  start: DateTime
}

"""Date range for filtering"""
input DateRangeInput {
  end: DateTime!
  start: DateTime!
}

scalar DateTime

input DateTimeFilter {
  """Exact date match"""
  equals: DateTime

  """Date after this value"""
  gt: DateTime

  """Date on or after this value"""
  gte: DateTime

  """Date before this value"""
  lt: DateTime

  """Date on or before this value"""
  lte: DateTime
}

"""Result of delete operations"""
union DeleteResult = AuthenticationError | AuthorizationError | DeleteSuccess | NotFoundError

"""Successful deletion result"""
type DeleteSuccess {
  """ID of the deleted resource"""
  deletedId: String

  """Deletion confirmation message"""
  message: String

  """Whether the deletion was successful"""
  success: Boolean
}

input EnhancedCreatePostInput {
  content: String
  publishAt: DateTime
  tags: [String!]
  title: String!
}

"""Post connection with enhanced metadata"""
type EnhancedPostConnection {
  """Number of draft posts in this connection"""
  draftCount: Int
  edges: [EnhancedPostEdge]

  """Summary of applied filters"""
  filterSummary: FilterSummary
  pageInfo: PageInfo!

  """Number of published posts in this connection"""
  publishedCount: Int

  """Metadata about the search query if applicable"""
  searchMetadata: SearchMetadata

  """Total number of posts matching the query"""
  totalCount: Int

  """Total views across all posts in this connection"""
  totalViews: Int
}

type EnhancedPostEdge {
  cursor: String!
  node: Post
}

"""User connection with enhanced metadata"""
type EnhancedUserConnection {
  """Number of users with at least one post"""
  activeUsers: Int
  edges: [EnhancedUserEdge]
  pageInfo: PageInfo!

  """Metadata about the search query if applicable"""
  searchMetadata: SearchMetadata

  """Total number of users matching the query"""
  totalCount: Int

  """Total posts by all users in this connection"""
  totalPosts: Int
}

type EnhancedUserEdge {
  cursor: String!
  node: User
}

"""Information about an applied filter"""
type FilterInfo {
  """The field being filtered"""
  field: String

  """The filter operator (e.g., equals, contains)"""
  operator: String

  """The filter value as a string"""
  value: String
}

"""Summary of filters applied to a query"""
type FilterSummary {
  """List of active filters"""
  activeFilters: [FilterInfo!]

  """Number of active filters"""
  filterCount: Int

  """Whether any filters are applied"""
  hasFilters: Boolean
}

input IntFilter {
  """Exact number match"""
  equals: Int

  """Greater than this value"""
  gt: Int

  """Greater than or equal to this value"""
  gte: Int

  """Value is in this list"""
  in: [Int!]

  """Less than this value"""
  lt: Int

  """Less than or equal to this value"""
  lte: Int

  """Value is not in this list"""
  notIn: [Int!]
}

scalar JSON

"""Post with automatic batch loading and caching"""
type LoadablePost {
  author: User
  content: String
  createdAt: DateTime
  id: ID
  metadata: PostMetadata
  published: Boolean
  title: String
  updatedAt: DateTime
  viewCount: Int
}

"""User with automatic batch loading and caching"""
type LoadableUser {
  createdAt: DateTime

  """Number of draft posts"""
  draftCount: Int
  email: String
  name: String

  """Total number of posts by this user"""
  postCount: Int
  posts(
    """Filter posts by published status"""
    published: Boolean
  ): [Post!]
  updatedAt: DateTime
}

type Mutation {
  """Create a new post"""
  createPostDirect(input: CreatePostInput!): Post

  """Delete a post"""
  deletePostDirect(id: ID!): Boolean

  """Increment the view count of a post"""
  incrementPostViewCountDirect(id: ID!): Post

  """Authenticate and receive a token"""
  loginDirect(email: String!, password: String!): String

  """Authenticate and receive access and refresh tokens"""
  loginWithTokens(email: String!, password: String!): AuthTokens

  """Authenticate and receive access and refresh tokens"""
  loginWithTokensDirect(email: String!, password: String!): AuthTokens

  """Logout user and revoke all refresh tokens"""
  logout: Boolean

  """Logout user and revoke all refresh tokens"""
  logoutDirect: Boolean

  """Refresh access token using a refresh token"""
  refreshToken(refreshToken: String!): AuthTokens

  """Refresh access token using a refresh token"""
  refreshTokenDirect(refreshToken: String!): AuthTokens

  """Create a post with comprehensive error handling"""
  safeCreatePost(input: CreatePostInput!): PostResult

  """Delete a post with comprehensive error handling"""
  safeDeletePost(id: ID!): DeleteResult

  """Authenticate with comprehensive error handling"""
  safeLogin(email: String!, password: String!): AuthResult

  """Create a new user account with comprehensive error handling"""
  safeSignup(email: String!, name: String, password: String!): AuthResult

  """Update a post with comprehensive error handling"""
  safeUpdatePost(id: ID!, input: UpdatePostInput!): PostResult

  """Create a new user account"""
  signupDirect(email: String!, name: String, password: String!): String

  """Toggle the publish status of a post"""
  togglePublishPostDirect(id: ID!): Post

  """Update an existing post"""
  updatePostDirect(id: ID!, input: UpdatePostInput!): Post

  """Update the current user profile"""
  updateUserProfile(input: UpdateUserInput!): User
}

interface Node {
  id: ID!
}

type NotFoundError {
  code: String
  message: String
  statusCode: Int
}

scalar ObjectID

type PageInfo {
  endCursor: String
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
}

type Post implements Node {
  """The user who created this post"""
  author: User

  """The content/body of the post"""
  content: String

  """When the post was first created"""
  createdAt: DateTime

  """A short excerpt from the post content (first 150 characters)"""
  excerpt: String
  id: ID!

  """Whether the current user is the owner of this post"""
  isOwner: Boolean

  """Whether the post is published and visible to the public"""
  published: Boolean

  """Estimated reading time in minutes (assuming 200 words per minute)"""
  readingTimeMinutes: Int

  """The title of the post"""
  title: String

  """When the post was last modified"""
  updatedAt: DateTime

  """Number of times this post has been viewed"""
  viewCount: Int

  """Approximate word count of the post content"""
  wordCount: Int
}

"""Aggregated post analytics"""
type PostAnalytics {
  """Average views per post"""
  averageViews: Int

  """The date range for this analytics data"""
  dateRange: DateRange

  """Top posts by view count"""
  topPostsByViews: [PostSummary!]

  """Total number of posts"""
  totalPosts: Int

  """Total views across all posts"""
  totalViews: Int
}

input PostCreateInput {
  """The content/body of the post"""
  content: String

  """The title of the post"""
  title: String!
}

"""Computed metadata for a post"""
type PostMetadata {
  """Whether the post has any content"""
  hasContent: Boolean

  """Estimated reading time in minutes"""
  readingTime: Int

  """Number of words in the post content"""
  wordCount: Int
}

input PostOrderByInput {
  """Order by creation date"""
  createdAt: SortOrder

  """Order by post ID"""
  id: SortOrder

  """Order by published status"""
  published: SortOrder

  """Order by post title"""
  title: SortOrder

  """Order by last update date"""
  updatedAt: SortOrder

  """Order by view count"""
  viewCount: SortOrder
}

input PostOrderByUpdatedAtInput {
  updatedAt: SortOrder!
}

"""Result of post mutations"""
union PostResult = AuthenticationError | AuthorizationError | NotFoundError | PostSuccess | ValidationError

"""Successful post operation result"""
type PostSuccess {
  """Success message"""
  message: String

  """The post that was created/updated"""
  post: Post
}

"""Summary information about a post"""
type PostSummary {
  """Post ID"""
  id: ID

  """Post title"""
  title: String

  """Number of views"""
  viewCount: Int
}

input PostUpdateInput {
  """New content for the post"""
  content: String

  """New published status for the post"""
  published: Boolean

  """New title for the post"""
  title: String
}

input PostWhereInput {
  """Filter posts by author ID"""
  authorId: IntFilter

  """Filter posts by content"""
  content: StringFilter

  """Filter posts by creation date"""
  createdAt: DateTimeFilter

  """Filter posts by published status"""
  published: BooleanFilter

  """Filter posts by title"""
  title: StringFilter

  """Filter posts by last update date"""
  updatedAt: DateTimeFilter

  """Filter posts by view count"""
  viewCount: IntFilter
}

type Query {
  """Load multiple users efficiently with DataLoader"""
  batchUsers(ids: [ID!]!): [LoadableUser!]

  """Get draft posts for the authenticated user"""
  draftsDirect(after: String, before: String, first: Int, last: Int): QueryDraftsDirectConnection

  """Advanced feed with metadata, search, and filtering"""
  enhancedFeed(
    after: String
    first: Int
    orderBy: [PostOrderByInput!]

    """Search posts by title or content"""
    searchTerm: String
    where: PostWhereInput
  ): EnhancedPostConnection

  """User search with aggregated metadata"""
  enhancedUserSearch(
    after: String
    first: Int

    """Include post statistics in results"""
    includePostStats: Boolean = false

    """Search users by name or email"""
    searchTerm: String!
  ): EnhancedUserConnection

  """Get published posts with optional search"""
  feedDirect(after: String, before: String, first: Int, last: Int, searchString: String): QueryFeedDirectConnection

  """Get a post using DataLoader for efficient loading"""
  loadablePost(id: ID!): LoadablePost

  """Get a user using DataLoader for efficient loading"""
  loadableUser(id: ID!): LoadableUser

  """Get the currently authenticated user"""
  meDirect: User

  """Optimized feed query with proper Prisma integration"""
  optimizedFeed(
    after: String
    before: String
    first: Int
    last: Int
    limit: Int
    offset: Int
    orderBy: PostOrderByInput

    """Search posts by title or content"""
    searchString: String
    where: PostWhereInput
  ): QueryOptimizedFeedConnection

  """Get aggregated analytics for posts"""
  postAnalytics(
    authorId: ID

    """Filter by date range"""
    dateRange: DateRangeInput
    published: Boolean
  ): PostAnalytics

  """Get a post by ID"""
  postDirect(id: ID!): Post

  """Search users by name or email"""
  searchUsersDirect(after: String, before: String, first: Int, last: Int, search: String!): QuerySearchUsersDirectConnection

  """Get a user by ID"""
  userDirect(id: ID!): User

  """Get all users with optional filtering"""
  usersDirect(after: String, before: String, first: Int, last: Int, orderBy: UserOrderByInput, where: UserWhereInput): QueryUsersDirectConnection
}

type QueryDraftsDirectConnection {
  edges: [QueryDraftsDirectConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type QueryDraftsDirectConnectionEdge {
  cursor: String!
  node: Post
}

type QueryFeedDirectConnection {
  edges: [QueryFeedDirectConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type QueryFeedDirectConnectionEdge {
  cursor: String!
  node: Post
}

type QueryOptimizedFeedConnection {
  edges: [QueryOptimizedFeedConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type QueryOptimizedFeedConnectionEdge {
  cursor: String!
  node: Post
}

type QuerySearchUsersDirectConnection {
  edges: [QuerySearchUsersDirectConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type QuerySearchUsersDirectConnectionEdge {
  cursor: String!
  node: User
}

type QueryUsersDirectConnection {
  edges: [QueryUsersDirectConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type QueryUsersDirectConnectionEdge {
  cursor: String!
  node: User
}

type RateLimitError {
  code: String
  message: String
  retryAfter: Int
  statusCode: Int
}

"""Metadata about a search query"""
type SearchMetadata {
  """Fields that were searched"""
  matchedFields: [String!]

  """The search query string"""
  query: String

  """Time taken to execute the search in milliseconds"""
  searchTime: Float
}

enum SortOrder {
  asc
  desc
}

input StringFilter {
  """String contains this value (case-insensitive)"""
  contains: String

  """String ends with this value"""
  endsWith: String

  """Exact string match"""
  equals: String

  """String does not equal this value"""
  not: String

  """String starts with this value"""
  startsWith: String
}

"""Result of token refresh operations"""
union TokenRefreshResult = AuthenticationError | TokenRefreshSuccess | ValidationError

"""Successful token refresh result"""
type TokenRefreshSuccess {
  """New JWT access token"""
  accessToken: String

  """Access token expiration time"""
  expiresAt: DateTime

  """New refresh token"""
  refreshToken: String
}

scalar UUID

input UpdatePostInput {
  content: String
  published: Boolean
  title: String
}

input UpdateUserInput {
  email: String
  name: String
}

type User implements Node {
  createdAt: DateTime

  """Number of unpublished posts by this user"""
  draftsCount: Int
  email: String
  id: ID!
  name: String

  """Total number of posts by this user"""
  postCount: Int
  posts(
    after: String
    before: String
    first: Int
    last: Int

    """Filter posts by published status"""
    published: Boolean
  ): UserPostsConnection

  """Posts created by this user"""
  postsDirect(
    after: String
    before: String
    first: Int
    last: Int

    """Filter by published status"""
    published: Boolean
  ): UserPostsDirectConnection

  """Number of published posts by this user"""
  publishedPostCount: Int

  """Number of published posts by this user"""
  publishedPostsCount: Int
  updatedAt: DateTime
}

input UserOrderByInput {
  """Order by user email"""
  email: SortOrder

  """Order by user ID"""
  id: SortOrder = asc

  """Order by user name"""
  name: SortOrder
}

type UserPostsConnection {
  edges: [UserPostsConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type UserPostsConnectionEdge {
  cursor: String!
  node: Post
}

type UserPostsDirectConnection {
  edges: [UserPostsDirectConnectionEdge]
  pageInfo: PageInfo!
  totalCount: Int!
}

type UserPostsDirectConnectionEdge {
  cursor: String!
  node: Post
}

"""Result of user mutations"""
union UserResult = AuthenticationError | ConflictError | UserSuccess | ValidationError

input UserSearchInput {
  """Search query"""
  query: String
}

"""Successful user operation result"""
type UserSuccess {
  """Success message"""
  message: String

  """The user that was created/updated"""
  user: User
}

input UserUniqueInput {
  """User email address"""
  email: String

  """User ID"""
  id: Int
}

input UserWhereInput {
  """Filter users by email"""
  email: StringFilter

  """Filter users by name"""
  name: StringFilter
}

type ValidationError {
  code: String
  message: String
  statusCode: Int
}